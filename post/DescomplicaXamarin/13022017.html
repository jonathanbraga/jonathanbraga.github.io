<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Jonathan Braga Blog and Site">
    <title>Mini projeto usando Web API em MVVM - Xamarin Forms</title>
    <link rel="icon" href="../../img/favicona.ico">
    <link rel="stylesheet" href="../../bower_components/pure/pure-min.css">
    <link rel="stylesheet" href="../../bower_components/pure/grids-responsive-min.css">
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
    <link rel="stylesheet" href="../post.css">
</head>

<body>
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-90844114-1', 'auto');
        ga('send', 'pageview');
    </script>
    <div id="main">
        <div class="header">
            <h1>Web API + Xamarin Forms + MVVM</h1>
        </div>

        <div class="content">
            <h2 class="content-subhead">
                <Start!></Start!>
            </h2>
            <p>
                Fala galera tranquilo? Sei que passei um tempo sem postar, mas esse post vai compensar! Vamos criar um mini projeto, onde iremos fazer chamada de uma WEB API (<a class="link" href="https://newsapi.org/">News API</a>), utilizaremos alguns
                componentes e faremos tudo isso usando a estrutura MVVM. Será um projeto bem simples e rapido onde tentarei dar uma noção bem básica de um projeto MVVM e de chamadas de APIs.
            </p>
            <center>
                <div class="pure-g">
                    <div class="pure-u-5-5">
                        <img class="pure-img-responsive" src="../../img/descomplicaXamarin/listview.png" alt="Xamarin Layouts Imagem">
                    </div>
                </div>
            </center>
            <h2 class="content-subhead">News API</h2>
            <p>
                O <a class="link" href="https://newsapi.org/">News API</a> é uma API simples e fácil de usar que retorna metadados JSON para as manchetes atuais publicadas em uma variedade de fontes de notícias e blogs. Possui uma exelente documentação,
                bem fácil de se entender. Para utilizar basta criar uma conta no site.
            </p>
            <h2 class="content-subhead">MVVM</h2>
            <p>
                O padrão de arquitetura Model-View-ViewModel (MVVM) foi inventado para o XAML. O padrão impõe uma separação da interface do usuário XAML (View) dos dados subjacentes (Model) através de uma classe que serve como um intermediário entre a View e o Model
                (ViewModel). O View e o ViewModel são frequentemente ligados através do BindingContext.
            </p>
            <center>
                <div class="pure-g">
                    <div class="pure-u-5-5">
                        <img class="pure-img-responsive" src="../../img/descomplicaXamarin/mvvm.png" alt="Xamarin Layouts Imagem">
                    </div>
                </div>
            </center>
            <h2 class="content-subhead">Let's Code!</h2>
            <p>
                Nesse nosso projeto vamos organizar a nossa Solution Explore de uma maneira um pouco diferente, se comparado com as outras. Iremos criar três pastas na nossa PCL, <b>Models</b>, <b>Views</b> e <b>ViewModels</b>, assim teremos a nossa estrutura
                MVVM.

                <ul>
                    <li>Project_API_NEWS</li>
                    <ul>
                        <li>Portable</li>
                        <ul>
                            <li>Models</li>
                            <li>Views</li>
                            <li>ViewlModels</li>
                        </ul>
                    </ul>
                    <ul>
                        <li>Droid</li>
                    </ul>
                    <ul>
                        <li>IOS</li>
                    </ul>
                </ul>
            </p>
            <h3 class="content-subhead">Vamos nessa!</h3>
            <p>Antes de tudo vamos instalar alguns pacotes ao nosso projeto <b>Portable</b>, usando o manage nuget packages, instale o Microsoft HTTP Client Libraries e Newtonsoft.Json .</p>
            <h3 class="content-subhead">Entendendo a News API</h3>
            <p>
                Para que possamos usar a API da melhor forma, iremos precisar entender como ela é construida e como iremos utilizar esses dados.
            </p>
            <pre>
                {
                    "status": "",
                    "source": "",
                    -"articles": [
                    -{
                        "author": 
                        "title": 
                        "description": 
                        "url": 
                        "urlToImage": 
                        "publishedAt":
                    }
                }
             </pre>
            <p>Observe que na chamada da API, temos alguns campos, iremos utilizar os dados referente a <b>articles</b>, pois são os de mais relevância para o nosso projeto.</p>
            <h3 class="content-subhead">Models</h3>
            <p>Agora que já se sabe quais são os campos que a API nos fornece e quais são os campos que irão ser utilizados, crie uma classe dentro da pasta <b>Models</b> e coloque o nome dessa classe de <b>Article</b>.</p>
            Article.cs
            <script src="https://gist.github.com/jonathanbraga/2428e943a8b846f412b303a9057fd08c.js"></script>
            </br>
            <h3 class="content-subhead">Helpers</h3>
            <p>
                Além das pastas que já criamos referentes ao MVVM, vamos criar mais uma, chamada de <b>Helpers.</b> Dentro de Helpers iremos criar uma Classe com o nome de <b>ApiCaller</b>. Será aqui onde iremos fazer a chamada da API. O endpoint que
                iremos utilizar será :
            </p>
            <p><b>https://newsapi.org/v1/articles?source=the-next-web&sortBy=latest&apiKey={my_api_key}</b></p>

            ApiCaller.cs
            <script src="https://gist.github.com/jonathanbraga/47fe0aa04c99a7dcb54b471daf164d63.js"></script>
            <br/>
            <h3 class="content-subhead">Controls</h3>
            <p>Do mesmo jeito que foi feito com a pasta Helpers, vamos criar uma nova pasta com o nome de <b>Controls</b> e dentro de controls crie uma classe com o nome de <b>BindablePicker</b>. Vamos criar essa classe com o intuito de ter o componente
                <b>Picker</b> com alguns dos atributos de uma listview.</p>
            BindablePicker.cs
            <script src="https://gist.github.com/jonathanbraga/2b720c34bb2a074ad448bbacfac47393.js"></script>
            <br/>
            <h3 class="content-subhead">ViewModels</h3>
            <p>Dentro da pasta <b>ViewModels</b> crie uma outra pasta chamada <b>Service</b> e dentro dela crie uma interface com o Nome de <b>INavigationService</b>. Com essa interface poderemos navegar entre Views via MVVM.</p>
            <script src="https://gist.github.com/jonathanbraga/9db976c15d2eea9515445f34140be18a.js"></script>
            <br/>
            <p>Vá na pasta <b>ViewModels</b> crie uma classe chama de <b>BaseViewModel</b>, essa classe Implementa o INotifyPropertyChanged.
            </p>
            BaseViewModel
            <script src="https://gist.github.com/jonathanbraga/bb1c530d845c51d9ea5f4b690ee46399.js"></script>
            <br/>
            <p>Após a implementação da classe BaseViewModel, podemos partir para criar a nossa HomeViewModel</p>
            HomeViewModel
            <script src="https://gist.github.com/jonathanbraga/bd5bd1648d53427b83f4a090e905171d.js"></script>
            <p>Dentro da pasta Views vamos criar a nossa <b>HomeView</b>.</p>
            HomeView.xaml
            <script src="https://gist.github.com/jonathanbraga/74ccd990c99e26277590bb38a16cd72c.js"></script>
            </br>
            <p>Ainda em Views vamos criar <b>SelectJournalView</b></p>
            SelectJournalView.xaml
            <script src="https://gist.github.com/jonathanbraga/4771cf30b6b85925b3f9b150ae346550.js"></script>
            <center>
                <div class="pure-g">
                    <div class="pure-u-1-3">
                        <img class="pure-img-responsive" src="../../img/Layouts e Componentes/tela1.png" alt="tela">
                    </div>
                    <div class="pure-u-1-4">
                    </div>
                    <div class="pure-u-1-3">
                        <img class="pure-img-responsive" src="../../img/Layouts e Componentes/tela2.png" alt="tela">
                    </div>
                </div>
            </center>
            <p>
                Para cada componente temos algumas propriedades, no segundo exemplo podemos ver isso de uma forma mais clara, como por exemplo:
                <li><b>Padding</b></li>
                <p>
                    É a definição de margem do layout, podemos inserir um valor único que irá servir para <i>left, top, right, and bottom</i> ou então difinir o valor de cada um (na respectiva ordem).
                </p>
                <li><b>ColumnDefinition</b></li>
                <p>
                    Será a maneira com que iremos configurar a divisão de nossa tela (nesse caso em colunas). Podemos usar tanto o "*" (o que resta da tela) como o "Auto" (o que o componente precisa).
                </p>
                <li><b>HorizontalTextAlignment</b></li>
                <p>
                    É a organização horizontal do texto.
                </p>
            </p>
            <h2 class="content-subhead">Hasta la vista baby!</h2>
            <p>
                Espero que tenham gostado desse post, espero que possamos aprender juntos nessa jornada!
            </p>
            <h3>Forte abraço!</h3>
        </div>
    </div>
    <script src="../prism.js"></script>
</body>

</html>